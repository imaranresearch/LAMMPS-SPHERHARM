# Test

variable	name string spherical_harmonics_testing
atom_style	spherharm 120 /home/james/lammps/examples/USER/spherharm/ellipsoid.dat
units		si
newton off
# newton on

###############################################
# Geometry-related parameters
###############################################

variable	boxx equal 500
variable	boxy equal 500
variable	boxz equal 500


#############
processors * * 1
region		boxreg block 0 ${boxx} 0 ${boxy} 0 ${boxz}
create_box	2 boxreg
change_box	all boundary f f f

create_atoms 	1 single 50.0 50.0 50.0

mass *      1.0
set 		atom 1 vx -1.0 vy 0.0 vz -1.0
set		atom 1 sh/shape 1
set		group all sh/quat 0 1 0 45.0

fix		time_fix all nve/sh
#fix     wall1 all wall/spherharm 1.0e-7 2.0 zplane NULL 90.0
fix     wall2 all wall/spherharm 1.0e-7 2.0 zplane NULL 10.0

neigh_modify	delay 0 every 1 check yes
comm_modify	vel yes

thermo 1

compute TransKE all ke
compute RotKE all erotate/spherharm
compute PEcalc all efunction/spherharm
variable ETotal equal "c_PEcalc + c_TransKE + c_RotKE"
thermo_style custom step c_PEcalc c_TransKE c_RotKE v_ETotal

timestep	1.0e-1

run     280
