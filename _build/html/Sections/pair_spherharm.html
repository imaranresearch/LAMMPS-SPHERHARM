<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pair_style spherharm command &mdash; SPHERHARM documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/lammps.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->

  
  <script src="../_static/js/modernizr.min.js"></script>
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Validation tests" href="validation.html" />
    <link rel="prev" title="fix wall/sh command" href="fix_wall_sh.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b></b></div>
              <div class="lammps_release">git info: 0.1</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_introduction.html">SPHERHARM Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_implementation.html">Implementation of SPHERHARM in LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="atom_style_spherharm.html">atom_style spherharm command</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_efunction_sphere.html">compute efunction/spherharm command</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_erotate_sphere.html">compute erotate/spherharm command</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_nve_sh.html">fix nve/sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_wall_sh.html">fix wall/sh command</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">pair_style spherharm command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mixing-shift-table-tail-correction-restart-rrespa-info">Mixing, shift, table, tail correction, restart, rRESPA info</a></li>
<li class="toctree-l2"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="#default">Default</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validation tests</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The implementation of DEM using Spherical Harmonic  in LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>pair_style spherharm command</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Sections/pair_spherharm.rst.txt" rel="nofollow"> View page source</a>
          <a href="https://github.com/imaranresearch/LAMMPS-SPHERHARM/tree/develop">Website</a>
          <!--   <a href="Commands_all.html">Commands</a> -->
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="fix_wall_sh.html" class="btn btn-neutral float-left" title="fix wall/sh command" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="validation.html" class="btn btn-neutral float-right" title="Validation tests" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pair-style-spherharm-command">
<span id="index-0"></span><h1>pair_style spherharm command<a class="headerlink" href="#pair-style-spherharm-command" title="Permalink to this heading">¶</a></h1>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span>pair_style spherharm
pair_coeff I J Kn exponent numerical_quad2
</pre></div>
</div>
<ul class="simple">
<li><p>cutoff = global cutoff (optional).  See discussion below.</p></li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span>pair_style granular
pair_coeff * * hooke 1000.0 50.0 tangential linear_nohistory 1.0 0.4 damping mass_velocity

pair_style granular
pair_coeff * * hooke 1000.0 50.0 tangential linear_history 500.0 1.0 0.4 damping mass_velocity

pair_style granular
pair_coeff * * hertz 1000.0 50.0 tangential mindlin 1000.0 1.0 0.4 limit_damping

pair_style granular
pair_coeff * * hertz/material 1e8 0.3 0.3 tangential mindlin_rescale NULL 1.0 0.4 damping tsuji

pair_style granular
pair_coeff 1 * jkr 1000.0 500.0 0.3 10 tangential mindlin 800.0 1.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall
pair_coeff 2 2 hertz 200.0 100.0 tangential linear_history 300.0 1.0 0.1 rolling sds 200.0 100.0 0.1 twisting marshall

pair_style granular
pair_coeff 1 1 dmt 1000.0 50.0 0.3 0.0 tangential mindlin NULL 0.5 0.5 rolling sds 500.0 200.0 0.5 twisting marshall
pair_coeff 2 2 dmt 1000.0 50.0 0.3 10.0 tangential mindlin NULL 0.5 0.1 rolling sds 500.0 200.0 0.1 twisting marshall
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>The <em>granular</em> styles support a variety of options for the normal,
tangential, rolling and twisting forces resulting from contact between
two granular particles. This expands on the options offered by the
<span class="xref std std-doc">pair gran/*</span> pair styles. The total computed forces
and torques are the sum of various models selected for the normal,
tangential, rolling and twisting modes of motion.</p>
<p>All model choices and parameters are entered in the
<span class="xref std std-doc">pair_coeff</span> command, as described below.  Unlike
e.g. <span class="xref std std-doc">pair gran/hooke</span>, coefficient values are not
global, but can be set to different values for different combinations
of particle types, as determined by the <span class="xref std std-doc">pair_coeff</span>
command.  If the contact model choice is the same for two particle
types, the mixing for the cross-coefficients can be carried out
automatically. This is shown in the last example, where model
choices are the same for type 1 - type 1 as for type 2 - type2
interactions, but coefficients are different. In this case, the
mixed coefficients for type 1 - type 2 interactions can be determined from
mixing rules discussed below.  For additional flexibility,
coefficients as well as model forms can vary between particle types,
as shown in the fourth example: type 1 - type 1 interactions are based
on a Johnson-Kendall-Roberts normal contact model and 2-2 interactions
are based on a DMT cohesive model (see below).  In that example, 1-1
and 2-2 interactions have different model forms, in which case mixing of
coefficients cannot be determined, so 1-2 interactions must be
explicitly defined via the <em>pair_coeff 1 *</em> command, otherwise an
error would result.</p>
<hr class="docutils" />
<p>The first required keyword for the <em>pair_coeff</em> command is the normal
contact model. Currently supported options for normal contact models
and their required arguments are:</p>
<ol class="arabic simple">
<li><p><em>hooke</em> : <span class="math notranslate nohighlight">\(k_n\)</span>, <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> (or <span class="math notranslate nohighlight">\(e\)</span>)</p></li>
<li><p><em>hertz</em> : <span class="math notranslate nohighlight">\(k_n\)</span>, <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> (or <span class="math notranslate nohighlight">\(e\)</span>)</p></li>
<li><p><em>hertz/material</em> : E, <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> (or <span class="math notranslate nohighlight">\(e\)</span>), <span class="math notranslate nohighlight">\(\nu\)</span></p></li>
<li><p><em>dmt</em> : E, <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> (or <span class="math notranslate nohighlight">\(e\)</span>), <span class="math notranslate nohighlight">\(\nu\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
<li><p><em>jkr</em> : E, <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> (or <span class="math notranslate nohighlight">\(e\)</span>), <span class="math notranslate nohighlight">\(\nu\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
</ol>
<p>Here, <span class="math notranslate nohighlight">\(k_n\)</span> is spring stiffness (with units that depend on model
choice, see below); <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> is a damping prefactor (or, in its
place a coefficient of restitution <span class="math notranslate nohighlight">\(e\)</span>, depending on the choice of
damping mode, see below); E is Young’s modulus in units of
<em>force</em>/<em>length</em>^2, i.e. <em>pressure</em>; <span class="math notranslate nohighlight">\(\nu\)</span> is Poisson’s ratio and
<span class="math notranslate nohighlight">\(\gamma\)</span> is a surface energy density, in units of
<em>energy</em>/<em>length</em>^2.</p>
<p>For the <em>hooke</em> model, the normal, elastic component of force acting
on particle <em>i</em> due to contact with particle <em>j</em> is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{ne, Hooke} = k_n \delta_{ij} \mathbf{n}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\delta_{ij} = R_i + R_j - \|\mathbf{r}_{ij}\|\)</span> is the particle
overlap, <span class="math notranslate nohighlight">\(R_i, R_j\)</span> are the particle radii, <span class="math notranslate nohighlight">\(\mathbf{r}_{ij} = \mathbf{r}_i - \mathbf{r}_j\)</span> is the vector separating the two
particle centers (note the i-j ordering so that <span class="math notranslate nohighlight">\(F_{ne}\)</span> is
positive for repulsion), and <span class="math notranslate nohighlight">\(\mathbf{n} = \frac{\mathbf{r}_{ij}}{\|\mathbf{r}_{ij}\|}\)</span>.  Therefore,
for <em>hooke</em>, the units of the spring constant <span class="math notranslate nohighlight">\(k_n\)</span> are
<em>force</em>/<em>distance</em>, or equivalently <em>mass</em>/<em>time^2</em>.</p>
<p>For the <em>hertz</em> model, the normal component of force is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{ne, Hertz} = k_n R_{eff}^{1/2}\delta_{ij}^{3/2} \mathbf{n}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(R_{eff} = \frac{R_i R_j}{R_i + R_j}\)</span> is the effective
radius, denoted for simplicity as <em>R</em> from here on.  For <em>hertz</em>, the
units of the spring constant <span class="math notranslate nohighlight">\(k_n\)</span> are <em>force</em>/<em>length</em>^2, or
equivalently <em>pressure</em>.</p>
<p>For the <em>hertz/material</em> model, the force is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{ne, Hertz/material} = \frac{4}{3} E_{eff} R_{eff}^{1/2}\delta_{ij}^{3/2} \mathbf{n}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(E_{eff} = E = \left(\frac{1-\nu_i^2}{E_i} + \frac{1-\nu_j^2}{E_j}\right)^{-1}\)</span> is the effective Young’s
modulus, with <span class="math notranslate nohighlight">\(\nu_i, \nu_j\)</span> the Poisson ratios of the particles of
types <em>i</em> and <em>j</em>. Note that if the elastic modulus and the shear
modulus of the two particles are the same, the <em>hertz/material</em> model
is equivalent to the <em>hertz</em> model with <span class="math notranslate nohighlight">\(k_n = 4/3 E_{eff}\)</span></p>
<p>The <em>dmt</em> model corresponds to the
<a class="reference internal" href="#dmt1975"><span class="std std-ref">(Derjaguin-Muller-Toporov)</span></a> cohesive model, where the force
is simply Hertz with an additional attractive cohesion term:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{ne, dmt} = \left(\frac{4}{3} E R^{1/2}\delta_{ij}^{3/2} - 4\pi\gamma R\right)\mathbf{n}\]</div>
<p>The <em>jkr</em> model is the <a class="reference internal" href="#jkr1971"><span class="std std-ref">(Johnson-Kendall-Roberts)</span></a> model,
where the force is computed as:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{ne, jkr} = \left(\frac{4Ea^3}{3R} - 2\pi a^2\sqrt{\frac{4\gamma E}{\pi a}}\right)\mathbf{n}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(a\)</span> is the radius of the contact zone, related to the overlap
<span class="math notranslate nohighlight">\(\delta\)</span> according to:</p>
<div class="math notranslate nohighlight">
\[\delta = a^2/R - 2\sqrt{\pi \gamma a/E}\]</div>
<p>LAMMPS internally inverts the equation above to solve for <em>a</em> in terms
of <span class="math notranslate nohighlight">\(\delta\)</span>, then solves for the force in the previous
equation. Additionally, note that the JKR model allows for a tensile
force beyond contact (i.e. for <span class="math notranslate nohighlight">\(\delta &lt; 0\)</span>), up to a maximum of
<span class="math notranslate nohighlight">\(3\pi\gamma R\)</span> (also known as the ‘pull-off’ force).  Note that this
is a hysteretic effect, where particles that are not contacting
initially will not experience force until they come into contact
<span class="math notranslate nohighlight">\(\delta \geq 0\)</span>; as they move apart and (<span class="math notranslate nohighlight">\(\delta &lt; 0\)</span>), they
experience a tensile force up to <span class="math notranslate nohighlight">\(3\pi\gamma R\)</span>, at which point they
lose contact.</p>
<hr class="docutils" />
<p>In addition, the normal force is augmented by a damping term of the
following general form:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{n,damp} = -\eta_n \mathbf{v}_{n,rel}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{v}_{n,rel} = (\mathbf{v}_j - \mathbf{v}_i) \cdot \mathbf{n}\ \mathbf{n}\)</span> is the component of relative velocity along
<span class="math notranslate nohighlight">\(\mathbf{n}\)</span>.</p>
<p>The optional <em>damping</em> keyword to the <em>pair_coeff</em> command followed by
a keyword determines the model form of the damping factor <span class="math notranslate nohighlight">\(\eta_n\)</span>,
and the interpretation of the <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> or <span class="math notranslate nohighlight">\(e\)</span> coefficients
specified as part of the normal contact model settings. The <em>damping</em>
keyword and corresponding model form selection may be appended
anywhere in the <em>pair coeff</em> command.  Note that the choice of damping
model affects both the normal and tangential damping (and depending on
other settings, potentially also the twisting damping).  The options
for the damping model currently supported are:</p>
<ol class="arabic simple">
<li><p><em>velocity</em></p></li>
<li><p><em>mass_velocity</em></p></li>
<li><p><em>viscoelastic</em></p></li>
<li><p><em>tsuji</em></p></li>
</ol>
<p>If the <em>damping</em> keyword is not specified, the <em>viscoelastic</em> model is
used by default.</p>
<p>For <em>damping velocity</em>, the normal damping is simply equal to the
user-specified damping coefficient in the <em>normal</em> model:</p>
<div class="math notranslate nohighlight">
\[\eta_n = \eta_{n0}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> is the damping coefficient specified for the normal
contact model, in units of <em>mass</em>/<em>time</em>.</p>
<p>For <em>damping mass_velocity</em>, the normal damping is given by:</p>
<div class="math notranslate nohighlight">
\[\eta_n = \eta_{n0} m_{eff}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\eta_{n0}\)</span> is the damping coefficient specified for the normal
contact model, in units of 1/<em>time</em> and
<span class="math notranslate nohighlight">\(m_{eff} = m_i m_j/(m_i + m_j)\)</span> is the effective mass.
Use <em>damping mass_velocity</em> to reproduce the damping behavior of
<em>pair gran/hooke/*</em>.</p>
<p>The <em>damping viscoelastic</em> model is based on the viscoelastic
treatment of <a class="reference internal" href="#brill1996"><span class="std std-ref">(Brilliantov et al)</span></a>, where the normal
damping is given by:</p>
<div class="math notranslate nohighlight">
\[\eta_n = \eta_{n0}\ a m_{eff}\]</div>
<p>Here, <em>a</em> is the contact radius, given by <span class="math notranslate nohighlight">\(a =\sqrt{R\delta}\)</span>
for all models except <em>jkr</em>, for which it is given implicitly according
to <span class="math notranslate nohighlight">\(\delta = a^2/R - 2\sqrt{\pi \gamma a/E}\)</span>.  For <em>damping viscoelastic</em>,
<span class="math notranslate nohighlight">\(\eta_{n0}\)</span> is in units of 1/(<em>time</em>*<em>distance</em>).</p>
<p>The <em>tsuji</em> model is based on the work of <a class="reference internal" href="#tsuji1992"><span class="std std-ref">(Tsuji et al)</span></a>. Here, the damping coefficient specified as part of
the normal model is interpreted as a restitution coefficient
<span class="math notranslate nohighlight">\(e\)</span>. The damping constant <span class="math notranslate nohighlight">\(\eta_n\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\eta_n = \alpha (m_{eff}k_n)^{1/2}\]</div>
<p>For normal contact models based on material parameters, <span class="math notranslate nohighlight">\(k_n = 4/3Ea\)</span>.  The parameter <span class="math notranslate nohighlight">\(\alpha\)</span> is related to the restitution
coefficient <em>e</em> according to:</p>
<div class="math notranslate nohighlight">
\[\alpha = 1.2728-4.2783e+11.087e^2-22.348e^3+27.467e^4-18.022e^5+4.8218e^6\]</div>
<p>The dimensionless coefficient of restitution <span class="math notranslate nohighlight">\(e\)</span> specified as part
of the normal contact model parameters should be between 0 and 1, but
no error check is performed on this.</p>
<p>The total normal force is computed as the sum of the elastic and
damping components:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_n = \mathbf{F}_{ne} + \mathbf{F}_{n,damp}\]</div>
<hr class="docutils" />
<p>The <em>pair_coeff</em> command also requires specification of the tangential
contact model. The required keyword <em>tangential</em> is expected, followed
by the model choice and associated parameters. Currently supported
tangential model choices and their expected parameters are as follows:</p>
<ol class="arabic simple">
<li><p><em>linear_nohistory</em> : <span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span>, <span class="math notranslate nohighlight">\(\mu_s\)</span></p></li>
<li><p><em>linear_history</em> : <span class="math notranslate nohighlight">\(k_t\)</span>, <span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span>, <span class="math notranslate nohighlight">\(\mu_s\)</span></p></li>
<li><p><em>mindlin</em> : <span class="math notranslate nohighlight">\(k_t\)</span> or NULL, <span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span>, <span class="math notranslate nohighlight">\(\mu_s\)</span></p></li>
<li><p><em>mindlin/force</em> : <span class="math notranslate nohighlight">\(k_t\)</span> or NULL, <span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span>, <span class="math notranslate nohighlight">\(\mu_s\)</span></p></li>
<li><p><em>mindlin_rescale</em> : <span class="math notranslate nohighlight">\(k_t\)</span> or NULL, <span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span>, <span class="math notranslate nohighlight">\(\mu_s\)</span></p></li>
<li><p><em>mindlin_rescale/force</em> : <span class="math notranslate nohighlight">\(k_t\)</span> or NULL, <span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span>, <span class="math notranslate nohighlight">\(\mu_s\)</span></p></li>
</ol>
<p>Here, <span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span> is a dimensionless multiplier for the normal
damping <span class="math notranslate nohighlight">\(\eta_n\)</span> that determines the magnitude of the tangential
damping, <span class="math notranslate nohighlight">\(\mu_t\)</span> is the tangential (or sliding) friction
coefficient, and <span class="math notranslate nohighlight">\(k_t\)</span> is the tangential stiffness coefficient.</p>
<p>For <em>tangential linear_nohistory</em>, a simple velocity-dependent Coulomb
friction criterion is used, which mimics the behavior of the <em>pair
gran/hooke</em> style. The tangential force <span class="math notranslate nohighlight">\(\mathbf{F}_t\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_t =  -\min(\mu_t F_{n0}, \|\mathbf{F}_\mathrm{t,damp}\|) \mathbf{t}\]</div>
<p>The tangential damping force <span class="math notranslate nohighlight">\(\mathbf{F}_\mathrm{t,damp}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_\mathrm{t,damp} = -\eta_t \mathbf{v}_{t,rel}\]</div>
<p>The tangential damping prefactor <span class="math notranslate nohighlight">\(\eta_t\)</span> is calculated by scaling
the normal damping <span class="math notranslate nohighlight">\(\eta_n\)</span> (see above):</p>
<div class="math notranslate nohighlight">
\[\eta_t = -x_{\gamma,t} \eta_n\]</div>
<p>The normal damping prefactor <span class="math notranslate nohighlight">\(\eta_n\)</span> is determined by the choice
of the <em>damping</em> keyword, as discussed above.  Thus, the <em>damping</em>
keyword also affects the tangential damping.  The parameter
<span class="math notranslate nohighlight">\(x_{\gamma,t}\)</span> is a scaling coefficient. Several works in the
literature use <span class="math notranslate nohighlight">\(x_{\gamma,t} = 1\)</span> (<a class="reference internal" href="#marshall2009"><span class="std std-ref">Marshall</span></a>,
<a class="reference internal" href="#tsuji1992"><span class="std std-ref">Tsuji et al</span></a>, <a class="reference internal" href="#silbert2001"><span class="std std-ref">Silbert et al</span></a>).  The relative
tangential velocity at the point of contact is given by
<span class="math notranslate nohighlight">\(\mathbf{v}_{t, rel} = \mathbf{v}_{t} - (R_i\mathbf{\Omega}_i + R_j\mathbf{\Omega}_j) \times \mathbf{n}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{v}_{t} = \mathbf{v}_r - \mathbf{v}_r\cdot\mathbf{n}\ \mathbf{n}\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{v}_r = \mathbf{v}_j - \mathbf{v}_i\)</span> .
The direction of the applied force is <span class="math notranslate nohighlight">\(\mathbf{t} = \mathbf{v_{t,rel}}/\|\mathbf{v_{t,rel}}\|\)</span> .</p>
<p>The normal force value <span class="math notranslate nohighlight">\(F_{n0}\)</span> used to compute the critical force
depends on the form of the contact model. For non-cohesive models
(<em>hertz</em>, <em>hertz/material</em>, <em>hooke</em>), it is given by the magnitude of
the normal force:</p>
<div class="math notranslate nohighlight">
\[F_{n0} = \|\mathbf{F}_n\|\]</div>
<p>For cohesive models such as <em>jkr</em> and <em>dmt</em>, the critical force is
adjusted so that the critical tangential force approaches <span class="math notranslate nohighlight">\(\mu_t F_{pulloff}\)</span>, see <a class="reference internal" href="#marshall2009"><span class="std std-ref">Marshall</span></a>, equation 43, and
<a class="reference internal" href="#thornton1991"><span class="std std-ref">Thornton</span></a>.  For both models, <span class="math notranslate nohighlight">\(F_{n0}\)</span> takes the
form:</p>
<div class="math notranslate nohighlight">
\[F_{n0} = \|\mathbf{F}_{ne} + 2 F_{pulloff}\|\]</div>
<p>Where <span class="math notranslate nohighlight">\(F_{pulloff} = 3\pi \gamma R\)</span> for <em>jkr</em>, and
<span class="math notranslate nohighlight">\(F_{pulloff} = 4\pi \gamma R\)</span> for <em>dmt</em>.</p>
<p>The remaining tangential options all use accumulated tangential
displacement (i.e. contact history), except for the options
<em>mindlin/force</em> and <em>mindlin_rescale/force</em>, that use accumulated
tangential force instead, and are discussed further below.
The accumulated tangential displacement is discussed in details below
in the context of the <em>linear_history</em> option. The same treatment of
the accumulated displacement applies to the other options as well.</p>
<p>For <em>tangential linear_history</em>, the tangential force is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_t =  -\min(\mu_t F_{n0}, \|-k_t\mathbf{\xi} + \mathbf{F}_\mathrm{t,damp}\|) \mathbf{t}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{\xi}\)</span> is the tangential displacement accumulated
during the entire duration of the contact:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\xi} = \int_{t0}^t \mathbf{v}_{t,rel}(\tau) \mathrm{d}\tau\]</div>
<p>This accumulated tangential displacement must be adjusted to account
for changes in the frame of reference of the contacting pair of
particles during contact. This occurs due to the overall motion of the
contacting particles in a rigid-body-like fashion during the duration
of the contact. There are two modes of motion that are relevant: the
‘tumbling’ rotation of the contacting pair, which changes the
orientation of the plane in which tangential displacement occurs; and
‘spinning’ rotation of the contacting pair about the vector connecting
their centers of mass (<span class="math notranslate nohighlight">\(\mathbf{n}\)</span>).  Corrections due to the
former mode of motion are made by rotating the accumulated
displacement into the plane that is tangential to the contact vector
at each step, or equivalently removing any component of the tangential
displacement that lies along <span class="math notranslate nohighlight">\(\mathbf{n}\)</span>, and rescaling to
preserve the magnitude.  This follows the discussion in
<a class="reference internal" href="#luding2008"><span class="std std-ref">Luding</span></a>, see equation 17 and relevant discussion in that
work:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\xi} = \left(\mathbf{\xi'} - (\mathbf{n} \cdot \mathbf{\xi'})\mathbf{n}\right) \frac{\|\mathbf{\xi'}\|}{\|\mathbf{\xi'} - (\mathbf{n}\cdot\mathbf{\xi'})\mathbf{n}\|}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{\xi'}\)</span> is the accumulated displacement prior to the
current time step and <span class="math notranslate nohighlight">\(\mathbf{\xi}\)</span> is the corrected
displacement. Corrections to the displacement due to the second mode
of motion described above (rotations about <span class="math notranslate nohighlight">\(\mathbf{n}\)</span>) are not
currently implemented, but are expected to be minor for most
simulations.</p>
<p>Furthermore, when the tangential force exceeds the critical force, the
tangential displacement is re-scaled to match the value for the
critical force (see <a class="reference internal" href="#luding2008"><span class="std std-ref">Luding</span></a>, equation 20 and related
discussion):</p>
<div class="math notranslate nohighlight">
\[\mathbf{\xi} = -\frac{1}{k_t}\left(\mu_t F_{n0}\mathbf{t} - \mathbf{F}_{t,damp}\right)\]</div>
<p>The tangential force is added to the total normal force (elastic plus
damping) to produce the total force on the particle. The tangential
force also acts at the contact point (defined as the center of the
overlap region) to induce a torque on each particle according to:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\tau}_i = -(R_i - 0.5 \delta) \mathbf{n} \times \mathbf{F}_t\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{\tau}_j = -(R_j - 0.5 \delta) \mathbf{n} \times \mathbf{F}_t\]</div>
<p>For <em>tangential mindlin</em>, the <a class="reference internal" href="#mindlin1949"><span class="std std-ref">Mindlin</span></a> no-slip solution
is used which differs from the <em>linear_history</em> option by an additional factor
of <span class="math notranslate nohighlight">\(a\)</span>, the radius of the contact region. The tangential force is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_t =  -\min(\mu_t F_{n0}, \|-k_t a \mathbf{\xi} + \mathbf{F}_\mathrm{t,damp}\|) \mathbf{t}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(a\)</span> is the radius of the contact region, given by <span class="math notranslate nohighlight">\(a =\sqrt{R\delta}\)</span>
for all normal contact models, except for <em>jkr</em>, where it is given
implicitly by <span class="math notranslate nohighlight">\(\delta = a^2/R - 2\sqrt{\pi \gamma a/E}\)</span>, see
discussion above. To match the Mindlin solution, one should set
<span class="math notranslate nohighlight">\(k_t = 8G_{eff}\)</span>, where <span class="math notranslate nohighlight">\(G_{eff}\)</span> is the effective shear modulus given by:</p>
<div class="math notranslate nohighlight">
\[G_{eff} = \left(\frac{2-\nu_i}{G_i} + \frac{2-\nu_j}{G_j}\right)^{-1}\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the shear modulus, related to Young’s modulus <span class="math notranslate nohighlight">\(E\)</span>
and Poisson’s ratio <span class="math notranslate nohighlight">\(\nu\)</span> by <span class="math notranslate nohighlight">\(G = E/(2(1+\nu))\)</span>. This can also be
achieved by specifying <em>NULL</em> for <span class="math notranslate nohighlight">\(k_t\)</span>, in which case a
normal contact model that specifies material parameters <span class="math notranslate nohighlight">\(E\)</span> and
<span class="math notranslate nohighlight">\(\nu\)</span> is required (e.g. <em>hertz/material</em>, <em>dmt</em> or <em>jkr</em>). In this
case, mixing of the shear modulus for different particle types <em>i</em> and
<em>j</em> is done according to the formula above.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The radius of the contact region <span class="math notranslate nohighlight">\(a\)</span> depends on the normal overlap.
As a result, the tangential force for <em>mindlin</em> can change due to
a variation in normal overlap, even with no change in tangential displacement.</p>
</div>
<p>For <em>tangential mindlin/force</em>, the accumulated elastic tangential force
characterizes the contact history, instead of the accumulated tangential
displacement. This prevents the dependence of the tangential force on the
normal overlap as noted above. The tangential force is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_t =  -\min(\mu_t F_{n0}, \|\mathbf{F}_{te} + \mathbf{F}_\mathrm{t,damp}\|) \mathbf{t}\]</div>
<p>The increment of the elastic component of the tangential force
<span class="math notranslate nohighlight">\(\mathbf{F}_{te}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\mathrm{d}\mathbf{F}_{te} = -k_t a \mathbf{v}_{t,rel} \mathrm{d}\tau\]</div>
<p>The changes in frame of reference of the contacting pair of particles during
contact are accounted for by the same formula as above, replacing the
accumulated tangential displacement <span class="math notranslate nohighlight">\(\xi\)</span>, by the accumulated tangential
elastic force <span class="math notranslate nohighlight">\(F_{te}\)</span>. When the tangential force exceeds the critical
force, the tangential force is directly re-scaled to match the value for
the critical force:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{te} = - \mu_t F_{n0}\mathbf{t} + \mathbf{F}_{t,damp}\]</div>
<p>The same rules as those described for <em>mindlin</em> apply regarding the tangential
stiffness and mixing of the shear modulus for different particle types.</p>
<p>The <em>mindlin_rescale</em> option uses the same form as <em>mindlin</em>, but the
magnitude of the tangential displacement is re-scaled as the contact
unloads, i.e. if <span class="math notranslate nohighlight">\(a &lt; a_{t_{n-1}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\xi} = \mathbf{\xi_{t_{n-1}}} \frac{a}{a_{t_{n-1}}}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(t_{n-1}\)</span> indicates the value at the previous time
step. This rescaling accounts for the fact that a decrease in the
contact area upon unloading leads to the contact being unable to
support the previous tangential loading, and spurious energy is
created without the rescaling above (<a class="reference internal" href="#waltonpc"><span class="std std-ref">Walton</span></a> ).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <em>mindlin</em>, a decrease in the tangential force already occurs as the
contact unloads, due to the dependence of the tangential force on the normal
force described above. By re-scaling <span class="math notranslate nohighlight">\(\xi\)</span>, <em>mindlin_rescale</em>
effectively re-scales the tangential force twice, i.e., proportionally to
<span class="math notranslate nohighlight">\(a^2\)</span>. This peculiar behavior results from use of the accumulated
tangential displacement to characterize the contact history. Although
<em>mindlin_rescale</em> remains available for historic reasons and backward
compatibility purposes, it should be avoided in favor of <em>mindlin_rescale/force</em>.</p>
</div>
<p>The <em>mindlin_rescale/force</em> option uses the same form as <em>mindlin/force</em>,
but the magnitude of the tangential elastic force is re-scaled as the contact
unloads, i.e. if <span class="math notranslate nohighlight">\(a &lt; a_{t_{n-1}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{te} = \mathbf{F}_{te, t_{n-1}} \frac{a}{a_{t_{n-1}}}\]</div>
<p>This approach provides a better approximation of the <a class="reference internal" href="#mindlin1953"><span class="std std-ref">Mindlin-Deresiewicz</span></a>
laws and is more consistent than <em>mindlin_rescale</em>. See discussions in
<a class="reference internal" href="#thornton2013"><span class="std std-ref">Thornton et al, 2013</span></a>, particularly equation 18(b) of that
work and associated discussion, and <a class="reference internal" href="#agnolinroux2007"><span class="std std-ref">Agnolin and Roux, 2007</span></a>,
particularly Appendix A.</p>
<hr class="docutils" />
<p>The optional <em>rolling</em> keyword enables rolling friction, which resists
pure rolling motion of particles. The options currently supported are:</p>
<ol class="arabic simple">
<li><p><em>none</em></p></li>
<li><p><em>sds</em> : <span class="math notranslate nohighlight">\(k_{roll}\)</span>, <span class="math notranslate nohighlight">\(\gamma_{roll}\)</span>, <span class="math notranslate nohighlight">\(\mu_{roll}\)</span></p></li>
</ol>
<p>If the <em>rolling</em> keyword is not specified, the model defaults to <em>none</em>.</p>
<p>For <em>rolling sds</em>, rolling friction is computed via a
spring-dashpot-slider, using a ‘pseudo-force’ formulation, as detailed
by <a class="reference internal" href="#luding2008"><span class="std std-ref">Luding</span></a>. Unlike the formulation in
<a class="reference internal" href="#marshall2009"><span class="std std-ref">Marshall</span></a>, this allows for the required adjustment of
rolling displacement due to changes in the frame of reference of the
contacting pair.  The rolling pseudo-force is computed analogously to
the tangential force:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{roll,0} =  k_{roll} \mathbf{\xi}_{roll}  - \gamma_{roll} \mathbf{v}_{roll}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{v}_{roll} = -R(\mathbf{\Omega}_i - \mathbf{\Omega}_j) \times \mathbf{n}\)</span> is the relative rolling
velocity, as given in <a class="reference internal" href="#wang2015"><span class="std std-ref">Wang et al</span></a> and
<a class="reference internal" href="#luding2008"><span class="std std-ref">Luding</span></a>. This differs from the expressions given by <a class="reference internal" href="#kuhn2004"><span class="std std-ref">Kuhn and Bagi</span></a> and used in <a class="reference internal" href="#marshall2009"><span class="std std-ref">Marshall</span></a>; see <a class="reference internal" href="#wang2015"><span class="std std-ref">Wang et al</span></a> for details. The rolling displacement is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\xi}_{roll} = \int_{t_0}^t \mathbf{v}_{roll} (\tau) \mathrm{d} \tau\]</div>
<p>A Coulomb friction criterion truncates the rolling pseudo-force if it
exceeds a critical value:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{roll} =  \min(\mu_{roll} F_{n,0}, \|\mathbf{F}_{roll,0}\|)\mathbf{k}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{k} = \mathbf{v}_{roll}/\|\mathbf{v}_{roll}\|\)</span> is the direction of
the pseudo-force.  As with tangential displacement, the rolling
displacement is rescaled when the critical force is exceeded, so that
the spring length corresponds the critical force. Additionally, the
displacement is adjusted to account for rotations of the frame of
reference of the two contacting particles in a manner analogous to the
tangential displacement.</p>
<p>The rolling pseudo-force does not contribute to the total force on
either particle (hence ‘pseudo’), but acts only to induce an equal and
opposite torque on each particle, according to:</p>
<div class="math notranslate nohighlight">
\[\tau_{roll,i} =  R_{eff} \mathbf{n} \times \mathbf{F}_{roll}\]</div>
<div class="math notranslate nohighlight">
\[\tau_{roll,j} =  -\tau_{roll,i}\]</div>
<hr class="docutils" />
<p>The optional <em>twisting</em> keyword enables twisting friction, which
resists rotation of two contacting particles about the vector
<span class="math notranslate nohighlight">\(\mathbf{n}\)</span> that connects their centers. The options currently
supported are:</p>
<ol class="arabic simple">
<li><p><em>none</em></p></li>
<li><p><em>sds</em> : <span class="math notranslate nohighlight">\(k_{twist}\)</span>, <span class="math notranslate nohighlight">\(\gamma_{twist}\)</span>, <span class="math notranslate nohighlight">\(\mu_{twist}\)</span></p></li>
<li><p><em>marshall</em></p></li>
</ol>
<p>If the <em>twisting</em> keyword is not specified, the model defaults to <em>none</em>.</p>
<p>For both <em>twisting sds</em> and <em>twisting marshall</em>, a history-dependent
spring-dashpot-slider is used to compute the twisting torque. Because
twisting displacement is a scalar, there is no need to adjust for
changes in the frame of reference due to rotations of the particle
pair. The formulation in <a class="reference internal" href="#marshall2009"><span class="std std-ref">Marshall</span></a> therefore provides
the most straightforward treatment:</p>
<div class="math notranslate nohighlight">
\[\tau_{twist,0} = -k_{twist}\xi_{twist} - \gamma_{twist}\Omega_{twist}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\xi_{twist} = \int_{t_0}^t \Omega_{twist} (\tau) \mathrm{d}\tau\)</span> is the twisting angular displacement, and
<span class="math notranslate nohighlight">\(\Omega_{twist} = (\mathbf{\Omega}_i - \mathbf{\Omega}_j) \cdot \mathbf{n}\)</span> is the relative twisting angular velocity. The torque
is then truncated according to:</p>
<div class="math notranslate nohighlight">
\[\tau_{twist} = \min(\mu_{twist} F_{n,0}, \tau_{twist,0})\]</div>
<p>Similar to the sliding and rolling displacement, the angular
displacement is rescaled so that it corresponds to the critical value
if the twisting torque exceeds this critical value:</p>
<div class="math notranslate nohighlight">
\[\xi_{twist} = \frac{1}{k_{twist}} (\mu_{twist} F_{n,0}sgn(\Omega_{twist}) - \gamma_{twist}\Omega_{twist})\]</div>
<p>For <em>twisting sds</em>, the coefficients <span class="math notranslate nohighlight">\(k_{twist}, \gamma_{twist}\)</span>
and <span class="math notranslate nohighlight">\(\mu_{twist}\)</span> are simply the user input parameters that follow
the <em>twisting sds</em> keywords in the <em>pair_coeff</em> command.</p>
<p>For <em>twisting_marshall</em>, the coefficients are expressed in terms of
sliding friction coefficients, as discussed in
<a class="reference internal" href="#marshall2009"><span class="std std-ref">Marshall</span></a> (see equations 32 and 33 of that work):</p>
<div class="math notranslate nohighlight">
\[k_{twist} = 0.5k_ta^2\]</div>
<div class="math notranslate nohighlight">
\[\eta_{twist} = 0.5\eta_ta^2\]</div>
<div class="math notranslate nohighlight">
\[\mu_{twist} = \frac{2}{3}a\mu_t\]</div>
<p>Finally, the twisting torque on each particle is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\tau}_{twist,i} = \tau_{twist}\mathbf{n}\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{\tau}_{twist,j} = -\mathbf{\tau}_{twist,i}\]</div>
<hr class="docutils" />
<p>If two particles are moving away from each other while in contact, there
is a possibility that the particles could experience an effective attractive
force due to damping. If the optional <em>limit_damping</em> keyword is used, this option
will zero out the normal component of the force if there is an effective
attractive force. This keyword cannot be used with the JKR or DMT models.</p>
<hr class="docutils" />
<p>The <em>granular</em> pair style can reproduce the behavior of the
<em>pair gran/*</em> styles with the appropriate settings (some very
minor differences can be expected due to corrections in
displacement history frame-of-reference, and the application
of the torque at the center of the contact rather than
at each particle). The first example above
is equivalent to <em>pair gran/hooke 1000.0 NULL 50.0 50.0 0.4 1</em>.
The second example is equivalent to
<em>pair gran/hooke/history 1000.0 500.0 50.0 50.0 0.4 1</em>.
The third example is equivalent to
<em>pair gran/hertz/history 1000.0 500.0 50.0 50.0 0.4 1</em>.</p>
<hr class="docutils" />
<p>LAMMPS automatically sets pairwise cutoff values for <em>pair_style
granular</em> based on particle radii (and in the case of <em>jkr</em> pull-off
distances). In the vast majority of situations, this is adequate.
However, a cutoff value can optionally be appended to the <em>pair_style
granular</em> command to specify a global cutoff (i.e. a cutoff for all
atom types). Additionally, the optional <em>cutoff</em> keyword can be passed
to the <em>pair_coeff</em> command, followed by a cutoff value.  This will
set a pairwise cutoff for the atom types in the <em>pair_coeff</em> command.
These options may be useful in some rare cases where the automatic
cutoff determination is not sufficient, e.g.  if particle diameters
are being modified via the <em>fix adapt</em> command. In that case, the
global cutoff specified as part of the <em>pair_style granular</em> command
is applied to all atom types, unless it is overridden for a given atom
type combination by the <em>cutoff</em> value specified in the <em>pair coeff</em>
command.  If <em>cutoff</em> is only specified in the <em>pair coeff</em> command
and no global cutoff is appended to the <em>pair_style granular</em> command,
then LAMMPS will use that cutoff for the specified atom type
combination, and automatically set pairwise cutoffs for the remaining
atom types.</p>
<hr class="docutils" />
</section>
<hr class="docutils" />
<section id="mixing-shift-table-tail-correction-restart-rrespa-info">
<h2>Mixing, shift, table, tail correction, restart, rRESPA info<a class="headerlink" href="#mixing-shift-table-tail-correction-restart-rrespa-info" title="Permalink to this heading">¶</a></h2>
<p>The <span class="xref std std-doc">pair_modify</span> mix, shift, table, and tail options
are not relevant for granular pair styles.</p>
<p>Mixing of coefficients is carried out using geometric averaging for
most quantities, e.g. if friction coefficient for type 1-type 1
interactions is set to <span class="math notranslate nohighlight">\(\mu_1\)</span>, and friction coefficient for type
2-type 2 interactions is set to <span class="math notranslate nohighlight">\(\mu_2\)</span>, the friction coefficient
for type1-type2 interactions is computed as <span class="math notranslate nohighlight">\(\sqrt{\mu_1\mu_2}\)</span>
(unless explicitly specified to a different value by a <em>pair_coeff 1 2
…</em> command). The exception to this is elastic modulus, only
applicable to <em>hertz/material</em>, <em>dmt</em> and <em>jkr</em> normal contact
models. In that case, the effective elastic modulus is computed as:</p>
<div class="math notranslate nohighlight">
\[E_{eff,ij} = \left(\frac{1-\nu_i^2}{E_i} + \frac{1-\nu_j^2}{E_j}\right)^{-1}\]</div>
<p>If the <em>i-j</em> coefficients <span class="math notranslate nohighlight">\(E_{ij}\)</span> and <span class="math notranslate nohighlight">\(\nu_{ij}\)</span> are
explicitly specified, the effective modulus is computed as:</p>
<div class="math notranslate nohighlight">
\[E_{eff,ij} = \left(\frac{1-\nu_{ij}^2}{E_{ij}} + \frac{1-\nu_{ij}^2}{E_{ij}}\right)^{-1}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[E_{eff,ij} = \frac{E_{ij}}{2(1-\nu_{ij})}\]</div>
<p>These pair styles write their information to <span class="xref std std-doc">binary restart files</span>, so a pair_style command does not need to be
specified in an input script that reads a restart file.</p>
<p>These pair styles can only be used via the <em>pair</em> keyword of the
<span class="xref std std-doc">run_style respa</span> command.  They do not support the
<em>inner</em>, <em>middle</em>, <em>outer</em> keywords.</p>
<p>The single() function of these pair styles returns 0.0 for the energy
of a pairwise interaction, since energy is not conserved in these
dissipative potentials.  It also returns only the normal component of
the pairwise interaction force.  However, the single() function also
calculates 12 extra pairwise quantities.  The first 3 are the
components of the tangential force between particles I and J, acting
on particle I.  The fourth is the magnitude of this tangential force.
The next 3 (5-7) are the components of the rolling torque acting on
particle I. The next entry (8) is the magnitude of the rolling torque.
The next entry (9) is the magnitude of the twisting torque acting
about the vector connecting the two particle centers.
The last 3 (10-12) are the components of the vector connecting
the centers of the two particles (x_I - x_J).</p>
<p>These extra quantities can be accessed by the <span class="xref std std-doc">compute pair/local</span> command, as <em>p1</em>, <em>p2</em>, …,
<em>p12</em>.</p>
</section>
<hr class="docutils" />
<section id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this heading">¶</a></h2>
<p>All the granular pair styles are part of the GRANULAR package.  It is
only enabled if LAMMPS was built with that package.  See the <span class="xref std std-doc">Build package</span> page for more info.</p>
<p>These pair styles require that atoms store torque and angular velocity
(omega) as defined by the <span class="xref std std-doc">atom_style</span>.  They also
require a per-particle radius is stored.  The <em>sphere</em> atom style does
all of this.</p>
<p>This pair style requires you to use the <span class="xref std std-doc">comm_modify vel yes</span> command so that velocities are stored by ghost
atoms.</p>
<p>These pair styles will not restart exactly when using the
<span class="xref std std-doc">read_restart</span> command, though they should provide
statistically similar results.  This is because the forces they
compute depend on atom velocities.  See the
<span class="xref std std-doc">read_restart</span> command for more details.</p>
</section>
<section id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this heading">¶</a></h2>
<p><span class="xref std std-doc">pair_coeff</span>
<span class="xref std std-doc">pair gran/*</span></p>
</section>
<section id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this heading">¶</a></h2>
<p>For the <em>pair_coeff</em> settings: <em>damping viscoelastic</em>, <em>rolling none</em>,
<em>twisting none</em>.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<p id="brill1996"><strong>(Brilliantov et al, 1996)</strong> Brilliantov, N. V., Spahn, F., Hertzsch,
J. M., &amp; Poschel, T. (1996).  Model for collisions in granular
gases. Physical review E, 53(5), 5382.</p>
<p id="tsuji1992"><strong>(Tsuji et al, 1992)</strong> Tsuji, Y., Tanaka, T., &amp; Ishida,
T. (1992). Lagrangian numerical simulation of plug flow of
cohesionless particles in a horizontal pipe. Powder technology, 71(3),
239-250.</p>
<p id="jkr1971"><strong>(Johnson et al, 1971)</strong> Johnson, K. L., Kendall, K., &amp; Roberts,
A. D. (1971).  Surface energy and the contact of elastic
solids. Proc. R. Soc. Lond. A, 324(1558), 301-313.</p>
<p id="dmt1975"><strong>Derjaguin et al, 1975)</strong> Derjaguin, B. V., Muller, V. M., &amp; Toporov,
Y. P. (1975). Effect of contact deformations on the adhesion of
particles. Journal of Colloid and interface science, 53(2), 314-326.</p>
<p id="luding2008"><strong>(Luding, 2008)</strong> Luding, S. (2008). Cohesive, frictional powders:
contact models for tension. Granular matter, 10(4), 235.</p>
<p id="marshall2009"><strong>(Marshall, 2009)</strong> Marshall, J. S. (2009). Discrete-element modeling
of particulate aerosol flows.  Journal of Computational Physics,
228(5), 1541-1561.</p>
<p id="silbert2001"><strong>(Silbert, 2001)</strong> Silbert, L. E., Ertas, D., Grest, G. S., Halsey,
T. C., Levine, D., &amp; Plimpton, S. J. (2001).  Granular flow down an
inclined plane: Bagnold scaling and rheology. Physical Review E,
64(5), 051302.</p>
<p id="kuhn2004"><strong>(Kuhn and Bagi, 2005)</strong> Kuhn, M. R., &amp; Bagi, K. (2004). Contact
rolling and deformation in granular media.  International journal of
solids and structures, 41(21), 5793-5820.</p>
<p id="wang2015"><strong>(Wang et al, 2015)</strong> Wang, Y., Alonso-Marroquin, F., &amp; Guo,
W. W. (2015).  Rolling and sliding in 3-D discrete element
models. Particuology, 23, 49-55.</p>
<p id="thornton1991"><strong>(Thornton, 1991)</strong> Thornton, C. (1991). Interparticle sliding in the
presence of adhesion.  J. Phys. D: Appl. Phys. 24 1942</p>
<p id="mindlin1949"><strong>(Mindlin, 1949)</strong> Mindlin, R. D. (1949). Compliance of elastic bodies
in contact.  J. Appl. Mech., ASME 16, 259-268.</p>
<p id="thornton2013"><strong>(Thornton et al, 2013)</strong> Thornton, C., Cummins, S. J., &amp; Cleary,
P. W. (2013).  An investigation of the comparative behavior of
alternative contact force models during inelastic collisions. Powder
Technology, 233, 30-46.</p>
<p id="waltonpc"><strong>(Otis R. Walton)</strong> Walton, O.R., Personal Communication</p>
<p id="mindlin1953"><strong>(Mindlin and Deresiewicz, 1953)</strong> Mindlin, R.D., &amp; Deresiewicz, H (1953).
Elastic Spheres in Contact under Varying Oblique Force.
J. Appl. Mech., ASME 20, 327-344.</p>
<p id="agnolinroux2007"><strong>(Agnolin and Roux 2007)</strong> Agnolin, I. &amp; Roux, J-N. (2007).
Internal states of model isotropic granular packings.
I. Assembling process, geometry, and contact networks. Phys. Rev. E, 76, 061302.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fix_wall_sh.html" class="btn btn-neutral float-left" title="fix wall/sh command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="validation.html" class="btn btn-neutral float-right" title="Validation tests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mohammad Imaran.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>