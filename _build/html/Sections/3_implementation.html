<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Implementation of SPHERHARM in LAMMPS &mdash; SPHERHARM documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/lammps.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->

  
  <script src="../_static/js/modernizr.min.js"></script>
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="atom_style spherharm command" href="atom_style_spherharm.html" />
    <link rel="prev" title="SPHERHARM Theory" href="2_introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b></b></div>
              <div class="lammps_release">git info: 0.1</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_introduction.html">SPHERHARM Theory</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Implementation of SPHERHARM in LAMMPS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#atom-style">Atom style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pair-style">Pair style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fix-style">Fix style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fix-nve-sh">fix NVE/sh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compute-styles">Compute styles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="atom_style_spherharm.html">atom_style spherharm command</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_efunction_sphere.html">compute efunction/spherharm command</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_erotate_sphere.html">compute erotate/spherharm command</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_nve_sh.html">fix nve/sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_wall_sh.html">fix wall/sh command</a></li>
<li class="toctree-l1"><a class="reference internal" href="pair_spherharm.html">pair_style spherharm command</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validation tests</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The implementation of DEM using Spherical Harmonic  in LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Implementation of SPHERHARM in LAMMPS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Sections/3_implementation.rst.txt" rel="nofollow"> View page source</a>
          <a href="https://github.com/imaranresearch/LAMMPS-SPHERHARM/tree/develop">Website</a>
          <!--   <a href="Commands_all.html">Commands</a> -->
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="2_introduction.html" class="btn btn-neutral float-left" title="SPHERHARM Theory" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="atom_style_spherharm.html" class="btn btn-neutral float-right" title="atom_style spherharm command" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="implementation-of-spherharm-in-lammps">
<h1>Implementation of SPHERHARM in LAMMPS<a class="headerlink" href="#implementation-of-spherharm-in-lammps" title="Permalink to this heading">¶</a></h1>
<section id="atom-style">
<h2>Atom style<a class="headerlink" href="#atom-style" title="Permalink to this heading">¶</a></h2>
<p>Atom style defines the set of properties of an atom used during a simulation in communication and input-output operations. Unlike traditional atom styles in LAMMPS, spherical harmonic particles are constructed in the simulation by supplying the shape coefficients. Any instance of this atom style accesses the appropriate coefficients. Spherical harmonic representation of the particles requires the multiple per-shape variables: shape coefficients <span class="math notranslate nohighlight">\(a_{nm}\)</span>, principle inertia <span class="math notranslate nohighlight">\(I_{1,2,3}\)</span>, initial quaternion <span class="math notranslate nohighlight">\(q_i\)</span>, and degree of spherical harmonic expansion <span class="math notranslate nohighlight">\(n\)</span>. Modified set commands further link these per-shape variables to per-atom or per-group properties. In order to add support for these quantities, a new data structure was created, which can be accessed using the following command:</p>
<section id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">atom_style</span> <span class="n">spherharm</span> <span class="n">N</span> <span class="n">numerical_quad1</span> <span class="n">shape_coeff</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
<ul class="simple">
<li><p>ID, group-ID are documented in compute command</p></li>
<li><p>erotate/sphere = style name of this compute command</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It should be noted that  per-shape properties are not the same as the per-type properties. A spherical harmonic atom type can contain only one shape, although a shape can belong to multiple types of spherical harmonic particles.</p>
</div>
</section>
</section>
<section id="pair-style">
<h2>Pair style<a class="headerlink" href="#pair-style" title="Permalink to this heading">¶</a></h2>
<p>In LAMMPS, two-body and multi-body interactions are implemented as the inter-particle potentials. In the current implementation of the <em>SPHERHARM</em>, inter-particle interaction is calculated as a function of the overlapped volume between the particles [feng paper].
The particles are represented by their bounding spheres when building neighbour lists and checking for potential contacts. Calculation of overlap volume,  in addition to other properties required by the contact theory, is handled through numerical integration over the spherical caps formed by the overlap of bounding spheres as detailed in section [ref section contact detection]. This is managed through the addition of standalone routines for spherical harmonic and quadrature functions, defined similarly to those in  MathExtra. The commands for pair style are as follows:</p>
<section id="id1">
<h3>Syntax<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span>pair_style spherharm
pair_coeff I J Kn exponent numerical_quad2
</pre></div>
</div>
</section>
</section>
<section id="fix-style">
<h2>Fix style<a class="headerlink" href="#fix-style" title="Permalink to this heading">¶</a></h2>
<p>The dynamics of a model are implemented by the use of different fix styles in LAMMPS. It contains a list of commands to perform specified operations during the dynamic time step. Two variants of the fix are implemented in the <em>SPHERHARM</em> package. Due to additional properties of the spherical harmonic particles, i.e. quaternion, and shtype, a new method based on the Velocity Verlet algorithm for time-stepping has been added. It can be accessed by the following command.</p>
<section id="fix-nve-sh">
<h3>fix NVE/sh<a class="headerlink" href="#fix-nve-sh" title="Permalink to this heading">¶</a></h3>
<p>In the simulation of granular particles, walls are often used to describe the boundary condition or flow to a certain region in space. This boundary condition can be stationary as well as moving. LAMMPS offers various fix wall/* commands to implement such rigid boundaries. However, these walls can not be used with a particle defined using the spherharm atom style. The spherharm atom style necessitates using the spherharm pair style to compute the interaction forces. Thus the newly implemented walls calculate the repulsive force for a particle-wall interaction by following the same methodology as for particle-particle interactions. The tangential friction force is calculated by  <em>calc_vel Coulomb_force_torque</em>  method, based on the velocity-dependent Coulomb friction described in texttt{pair granular}.
A suitable wall surface can be  provided by</p>
</section>
<section id="id2">
<h3>Syntax<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span>fix ID group_ID wall/spherharm Kn exponent Kt wallstyle args keyword values
</pre></div>
</div>
<p>This wall style takes <strong>translate</strong> keyword and velocities :math: <cite>v_x, v_y, v_z</cite>  as values to implement moving walls.</p>
</section>
</section>
<section id="compute-styles">
<h2>Compute styles<a class="headerlink" href="#compute-styles" title="Permalink to this heading">¶</a></h2>
<p>Compute styles in LAMMPS are used to calculate the properties of the system at different instances as they are invoked. They operate on specified groups or chunks of atoms, and they produce output which is stored internally for use by other commands. In <em>SPHERHARM</em> package, two compute styles are implemented to calculate the system’s rotational kinetic energy o and potential energy. The following compute style is used to calculate the rotational kinetic energy o of a group of spherical harmonic particles.</p>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span>compute ID group-ID erotate/spherharm
</pre></div>
</div>
<p>The rotational energy is computed as <span class="math notranslate nohighlight">\(E_{rot} = 0.5*I.\omega^2\)</span>, where :math: <cite>I</cite> is the moment of inertia  and <span class="math notranslate nohighlight">\(\omega\)</span> is the particle’s angular velocity. Similarly, another compute is implemented to calculate the potential energy of a particle group by calculating the incremental work done by the potential. This compute style can be invoked by</p>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span>compute ID group-ID efunction/spherharm
</pre></div>
</div>
<p>The work done by the potential over a time step is a combination of that done from the “back half” <span class="math notranslate nohighlight">\(t -&gt; t+dt/2\)</span> and the “front half” <span class="math notranslate nohighlight">\(t+dt/2-&gt;t+dt\)</span> of the time step. At the end of the time step, i.e <span class="math notranslate nohighlight">\(t+dt\)</span>, it is not possible to calculate the “back half” of the work done, so this must be carried forward from the previous time step.
These compute styles calculate global scalars and can be used by other commands that use a global scalar value from a compute as input.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2_introduction.html" class="btn btn-neutral float-left" title="SPHERHARM Theory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="atom_style_spherharm.html" class="btn btn-neutral float-right" title="atom_style spherharm command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mohammad Imaran.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>